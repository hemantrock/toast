gTooltips=new Array();gTooltipsOk=!window.attachEvent;function Tooltip(D,C){this.init(D,C);this._tipId=C;this._divId=D}Tooltip.prototype.init=function(F,D){this.type="over";this.align="left";this.valign="top";this.where="right";this.hideDelayMs=200;this.showDelayMs=700;this.displayedDelayMs=1000;this.divId=F;this.div=document.getElementById(F);if(D==null||D==undefined){this.tipId=Math.round(10000*Math.random())+"-tooltip"}else{this.tipId=D}this.tip=document.getElementById(this.tipId);if(this.tip==null){var E=document.createElement("DIV");E.id=this.tipId;this.tip=E}this.div.onmouseover=new Function("tooltipHandler('"+this.tipId+"', -1, 'over')");this.div.onmouseout=new Function("tooltipHandler('"+this.tipId+"', -1, 'out')");this.tip.onclick=new Function("tooltipHandler('"+this.tipId+"', -1, 'click')");this.tip.onmouseover=new Function("tooltipHandler('"+this.tipId+"', -1, 'over')");this.tip.onmouseout=new Function("tooltipHandler('"+this.tipId+"', -1, 'out')");this.tip.className="tooltip";this.tip.style.display="inline";this.tip.style.position="absolute";this.tip.style.visibility="hidden";gTooltips[this.tipId]=this};Tooltip.prototype.show=function(){if(gTooltipsOk){if(this.width!=null){this.tip.style.width=this.width}if(this.height!=null){this.tip.style.height=this.height}if(this.content!=null){this.tip.innerHTML=this.content}if(document.getElementById(this.tipId)==null){document.body.appendChild(this.tip)}var G=this.findPosition(this.div);var F=G[0];var H=G[1];var I=this.findSize(this.div);var J=this.findSize(this.tip);switch(this.where){case"above":H-=(J[1]+4);break;case"below":H+=(I[1]+4);break;case"left":F-=(J[0]+4);break;case"boundedleft":F-=(J[0]+4);if(F<4){F=4}break;case"boundedleftshiftdown":F-=(J[0]+4);if(F<4){F=4}H+=2;break;case"center":F-=(J[0]/2);break;case"right":F+=(I[0]+4);break;case"leftabove":H-=(J[1]+4);F-=(J[0]+4);break;case"leftbelow":H+=(I[1]+4);F-=(J[0]+4);break;case"rightabove":H-=(J[1]+4);F+=(I[0]+4);break;case"rightbelow":H+=(I[1]+4);F+=(I[0]+4);break;default:F-=(J[0]+4);break}if(F==G[0]){if(this.align=="right"){F+=I[0]-J[0]}else{if(this.align=="center"){F+=(I[0]-J[0])/2}}}if(H==G[1]){if(this.valign=="bottom"){H+=I[1]-J[1]}else{if(this.valign=="center"){H+=(I[1]-J[1])/2}}}if(this.onShow){this.onShow()}this.tip.style.top=H+"px";this.tip.style.left=F+"px";this.tip.style.textAlign="center";this.tip.style.visibility="visible"}};Tooltip.prototype.hide=function(){this.tip.style.visibility="hidden";if(this.onHide){this.onHide()}};Tooltip.prototype.findPosition=function(E){var F=0;var D=0;if(E.offsetParent){D=E.offsetLeft;F=E.offsetTop;while(E=E.offsetParent){D+=E.offsetLeft;F+=E.offsetTop}}return[D,F]};Tooltip.prototype.findSize=function(E){var F=(E.offsetWidth)?E.offsetWidth:(E.clip)?E.clip.width:0;var D=(E.offsetWidth)?E.offsetHeight:(E.clip)?E.clip.height:0;return[F,D]};function tooltipHandler(F,H,E){var G=gTooltips[F];clearTimeout(G.timer);switch(E){case"click":if(G.type=="click"){G.show()}if(G.type=="over_momentarily"){G.hide()}break;case"over":if(G.type=="over"){if(H==0){G.show()}else{G.timer=setTimeout("tooltipHandler('"+F+"', 0, 'over')",G.showDelayMs)}}if(G.type=="over_momentarily"){if(H==0){G.show();G.timer=setTimeout("tooltipHandler('"+F+"', 0, 'out')",G.displayedDelayMs)}else{G.timer=setTimeout("tooltipHandler('"+F+"', 0, 'over')",G.showDelayMs)}}break;case"out":if(H==0){G.hide()}else{G.timer=setTimeout("tooltipHandler('"+F+"', 0, 'out')",G.hideDelayMs)}break}}function setTooltipOk(){gTooltipsOk=true}if(window.attachEvent){window.attachEvent("onload",setTooltipOk)};